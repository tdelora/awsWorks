#!/usr/bin/env python3
import sys
import aws_kpc, aws_icc

exitBeforeCreate = False

# Exit if keypair is not provided
if len(sys.argv) == 2:
	print("Checking keypair " + sys.argv[1])
else:
	print("\nUsage: %s <keypair>" % sys.argv[0])
	print("\nIf the specified <keypair> does not exist it will be created.")
	print("\nAt completion the AWS instance id will be evented.")
	print("\n")
	quit()


returnValue = aws_kpc.aws_kp_check(sys.argv[1])

if returnValue == "create":
	if ( aws_kpc.aws_kp_create(sys.argv[1]) == 0 ):
		exitBeforeCreate = True
elif returnValue == "quit":
	exitBeforeCreate = True
else:
	print("keypair " + sys.argv[1] + " exists")

if ( exitBeforeCreate ):
	print(sys.argv[0] + " : exiting")
	quit()

instance = aws_icc.aws_create_instance('ami-0e65ed16c9bf1abc7','t2.micro',sys.argv[1])
print(instance[0].id)

"""
ec2 = boto3.client('ec2')
response = ec2.describe_instances()
print(response)
"""

quit()
